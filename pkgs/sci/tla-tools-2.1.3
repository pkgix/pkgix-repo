# Based on: http://aur.archlinux.org/packages/tl/tla-tools/PKGBUILD

version=2.1.3
description="Tools for the TLA+2 language"
depends=()
license=('custom:MSR-EULA')
website="http://research.microsoft.com/en-us/um/people/lamport/tla/tools.html"

isinstalled() {
	return 1
}

iscompat() {
	return 0
}

build() {
	fetch_extract \
		"http://ftp.research.microsoft.com/downloads/41b4a0aa-5fad-4118-916a-45ed9fd48bf0/tla.zip" \
		"c8575fa589bf5e8ee8ced8cb464ab7763d6177f2994a7cf172d0997787e537a8"
}

installenv() {
	mkdir -p \
		"${destdir}/${prefix}/bin" \
		"${destdir}/${prefix}/share/java" \
		"${destdir}/${prefix}/share/licenses/tla-tools"

	cp -a "tla" "${destdir}/${prefix}/share/java/tla-tools"

	cat > pcal2tla <<EOF
#!/bin/sh
exec java -classpath "${prefix}/share/java/tla-tools" pcal.trans "\$@"
EOF

	cat > sany <<EOF
#!/bin/sh
exec java -classpath "${prefix}/share/java/tla-tools" tla2sany.SANY "\$@"
EOF

	cat > tla2tex <<EOF
#!/bin/sh
exec java -classpath "${prefix}/share/java/tla-tools" tla2tex.TLA "\$@"
EOF

	cat > tlc <<EOF
#!/bin/sh
exec java -classpath "${prefix}/share/java/tla-tools" tlc2.TLC "\$@"
EOF

	install -D -m 0755 {pcal2tla,sany,tla2tex,tlc} "${destdir}/${prefix}/bin"
	install -D -m 0644 "tla/License.txt" "${destdir}/${prefix}/share/licenses/tla-tools/LICENSE"
}

# vim: set ft=sh:
